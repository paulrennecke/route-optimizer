<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waypoint Optimizer</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/config.js"></script>
</head>
<body>    <header>
        <h1>Waypoint Optimizer</h1>
    </header>
    
    <main>
        <section id="inputs">          
            <div class="addresses-header-row">
                <h2>Addresses</h2>
                <button id="import-google-contacts" class="btn google-contacts-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 48 48">
                        <linearGradient id="kc7hH-6k49NRxmckDagkua_pl3IewmCnUpu_gr1" x1="-207.274" x2="-188.659" y1="79.108" y2="97.723" gradientTransform="translate(222.127 -52.643)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#55adfd"></stop><stop offset="1" stop-color="#438ffd"></stop></linearGradient><path fill="url(#kc7hH-6k49NRxmckDagkua_pl3IewmCnUpu_gr1)" d="M6.999,41.499c0-0.635,0-4.156,0-5.5 c0-6.624,5.376-12,12-12c0.521,0,1.212,0,2.009,0c0.819,0,2.013,2,2.991,2c1.063,0,1.917-2,3.003-2c2.521,0,4.876,0,5.997,0 c4.416,0,8,3.584,8,8c0,0.691,0,3.311,0,4c0,4.416-3.584,8-8,8c-0.793,0-3.107,0-5.992,0c-1.628,0-3.187-3-5.008-3 c-2.181,0-4.629,3-6.551,3c-3.192,0-5.623,0-5.949,0C8.119,43.999,6.999,42.879,6.999,41.499z"></path><linearGradient id="kc7hH-6k49NRxmckDagkub_pl3IewmCnUpu_gr2" x1="-203.901" x2="-187.985" y1="75.663" y2="91.579" gradientTransform="translate(218.61 -49.343)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#427fdb"></stop><stop offset="1" stop-color="#0c52bb"></stop></linearGradient><path fill="url(#kc7hH-6k49NRxmckDagkub_pl3IewmCnUpu_gr2)" d="M12.999,41.499v-9.5c0-4.416,3.584-8,8-8 c1.06,0,4.939,0,6,0c4.416,0,8,3.584,8,8c0,0.691,0,3.311,0,4c0,4.416-3.584,8-8,8h-11.5C14.119,43.999,12.999,42.879,12.999,41.499 z"></path><linearGradient id="kc7hH-6k49NRxmckDagkuc_pl3IewmCnUpu_gr3" x1="-202.589" x2="-191.884" y1="70.278" y2="80.983" gradientTransform="translate(220.932 -63.935)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#427fdb"></stop><stop offset="1" stop-color="#0c52bb"></stop></linearGradient><path fill="url(#kc7hH-6k49NRxmckDagkuc_pl3IewmCnUpu_gr3)" d="M23.999,3.998c4.416,0,8.001,3.585,8.001,8.001 c0,4.416-3.585,8.001-8.001,8.001s-8.001-3.585-8.001-8.001C15.998,7.583,19.583,3.998,23.999,3.998z"></path>
                    </svg>
                    Load Google Contacts
                </button>
            </div>
                
                <div class="address-input start">
                    <label for="start">Starting Point:</label>
                    <input type="text" id="start" class="address-autocomplete" placeholder="Enter start address">
                </div>
                  <div id="waypoints-container">
                    <!-- Waypoints will be dynamically added here -->
                </div>
                
                <button id="add-waypoint" class="btn">Add Waypoint</button>
                
                <div class="address-input end">
                    <label for="end">Destination:</label>
                    <input type="text" id="end" class="address-autocomplete" placeholder="Enter destination address">
                </div>
            </div>
              <div class="options-container">
                <h2>Options</h2>
                <div class="option">
                    <label for="optimization-preference">Optimize for:</label>
                    <select id="optimization-preference">
                        <option value="distance">Shortest Distance</option>
                        <option value="time" selected>Shortest Time</option>
                    </select>
                </div>
                <div class="option">
                    <label for="travel-mode">Transportation Mode:</label>
                    <div class="travel-mode-container">
                        <div class="travel-mode-option">
                            <input type="radio" id="driving" name="travel-mode" value="DRIVING" checked>                            
                            <label for="driving" class="travel-mode-label">
                                <span class="travel-mode-icon">ðŸš—</span>
                                <span class="travel-mode-text">Car</span>
                            </label>
                        </div>
                        <div class="travel-mode-option">
                            <input type="radio" id="bicycling" name="travel-mode" value="BICYCLING">
                            <label for="bicycling" class="travel-mode-label">
                                <span class="travel-mode-icon">ðŸš²</span>
                                <span class="travel-mode-text">Bicycle</span>
                            </label>
                        </div>
                        <div class="travel-mode-option">
                            <input type="radio" id="walking" name="travel-mode" value="WALKING">
                            <label for="walking" class="travel-mode-label">
                                <span class="travel-mode-icon">ðŸš¶</span>
                                <span class="travel-mode-text">Walking</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <button id="calculate-route" class="btn primary">Optimize Route</button>
        </section>
          <section id="results" class="hidden">
            <div class="optimized-route">
                <h2>Optimized Route</h2>
                <div class="route-summary">
                    <p id="total-distance">Total Distance: <span></span></p>
                    <p id="total-duration">Total Time: <span></span></p>
                </div>
                <div class="route-list">
                    <ol id="optimized-stops">
                        <!-- List of optimized stops -->
                    </ol>
                </div>
                <button id="export-route" class="btn">Export Route</button>
                <button id="save-route" class="btn">Save Route</button>
            </div>
            <div id="map-container">
                <div id="map"></div>
            </div>
        </section>
    </main>

    <!-- GitHub Link - Bottom Right -->
    <div class="github-link-fixed">
        <a href="https://github.com/paulrennecke/route-optimizer" target="_blank" class="text-decoration-none">
            <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
            </svg>
        </a>
    </div>

    <!-- JavaScript-Dateien -->
    <script src="js/ui-controller.js"></script>
    <script src="js/map-handler.js"></script>
    <script src="js/api-service.js"></script>
    <script src="js/route-optimizer.js"></script>
    <script src="js/app.js"></script>
    <script>
        // Replace deprecated google.maps.places.Autocomplete with PlaceAutocompleteElement
        const setupAutocomplete = (input) => {
            // Remove old autocomplete if present
            if (input._autocompleteElement) {
                input._autocompleteElement.remove();
                input._autocompleteElement = null;
            }
            // Create the new PlaceAutocompleteElement
            const autocompleteElement = document.createElement('gmpx-place-autocomplete');
            autocompleteElement.setAttribute('input-element', input);
            // Optionally, set more attributes for biasing, etc.
            input.parentNode.insertBefore(autocompleteElement, input.nextSibling);
            input._autocompleteElement = autocompleteElement;
            return autocompleteElement;
        };
    </script>
</body>
</html>